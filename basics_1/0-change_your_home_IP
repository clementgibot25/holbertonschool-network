#!/usr/bin/env bash
# configure_hosts.sh
# Script to configure custom host resolutions on Ubuntu

set -e

HOSTS_FILE="/etc/hosts"

# Ensure script is run as root
if [ "$EUID" -ne 0 ]; then
  echo "Please run as root (use sudo)."
  exit 1
fi

# Backup the original hosts file if not already backed up
if [ ! -f "${HOSTS_FILE}.bak" ]; then
  cp "$HOSTS_FILE" "${HOSTS_FILE}.bak"
  echo "Backup created at ${HOSTS_FILE}.bak"
fi

# Remove any existing localhost or facebook.com entries
sed -i '/[[:space:]]localhost$/d' "$HOSTS_FILE"
sed -i '/[[:space:]]facebook.com$/d' "$HOSTS_FILE"

# Add required entries
echo "127.0.0.2   localhost" >> "$HOSTS_FILE"
echo "8.8.8.8     facebook.com" >> "$HOSTS_FILE"

echo "Custom host configuration applied successfully."
